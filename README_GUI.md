# 🎬 VideoTranslator - GUI版本使用指南

## 📦 安装步骤

### 1. 安装Python依赖

首先安装基础依赖：

```bash
pip install -r requirements.txt
```

然后安装GUI依赖：

```bash
pip install -r requirements_gui.txt
```

### 2. 验证安装

确保以下命令可以正常运行：

```bash
python3 -c "from PyQt6.QtWidgets import QApplication"
```

如果没有报错，说明安装成功。

## 🚀 启动应用

在项目目录下运行：

```bash
python3 gui_app.py
```

应用窗口将会打开。

## 📖 使用说明

### 界面介绍

应用界面分为四个主要区域：

1. **拖拽区域** (顶部)
   - 拖拽视频文件到此区域
   - 或点击区域选择文件
   - 支持格式：MP4, MOV, AVI, MKV, FLV

2. **配置区域** (中部)
   - **目标语言**：选择要翻译成的语言
   - **配音音色**：根据目标语言自动显示可用音色
   - **字幕位置**：选择底部/顶部/中间
   - **字幕边距**：调整字幕与边缘的距离

3. **操作按钮** (中部)
   - **🚀 开始处理**：启动完整工作流
   - **⏹ 取消**：取消当前处理
   - **📁 打开输出文件夹**：在Finder中查看输出文件

4. **进度显示** (底部)
   - 进度条显示整体进度
   - 状态文本显示当前步骤
   - 日志窗口实时显示处理过程

### 完整工作流

应用会自动执行以下4个步骤：

1. **📝 提取字幕**：使用Whisper识别原视频的语音
2. **🌍 翻译字幕**：将字幕翻译成目标语言
3. **🎙️ 生成配音**：使用Edge TTS生成配音音频
4. **🎬 合成视频**：将字幕和配音合成到视频中

### 输出文件

处理完成后，将在原视频同目录下生成：

- `原文件名_original.srt` - 原语言字幕
- `原文件名_目标语言.srt` - 翻译后的字幕
- `原文件名_目标语言_voiceover.mp3` - 配音音频
- `原文件名_目标语言_final.mp4` - 最终视频（包含字幕和配音）

### 配置保存

应用会自动保存您的偏好设置：

- 上次选择的目标语言
- 上次选择的音色
- 字幕位置和边距设置
- 窗口大小和位置

配置文件位置：`~/Library/Application Support/VideoTranslator/config.json`

## 💡 使用技巧

### 1. 拖拽文件

最快的方式是直接从Finder拖拽视频文件到应用窗口。

### 2. 实时日志

处理过程中，底部的日志窗口会实时显示：
- 当前执行的步骤
- 进度信息
- 可能的错误信息

### 3. 随时取消

如果需要中断处理，点击"取消"按钮即可。已生成的中间文件会保留。

### 4. 查看输出

处理完成后：
- 点击弹窗中的"确定"
- 点击"打开输出文件夹"按钮
- 即可在Finder中查看所有生成的文件

## ⚙️ 系统要求

- **操作系统**：macOS 10.15+
- **Python版本**：Python 3.8+
- **内存**：建议8GB+（处理大视频时）
- **磁盘空间**：处理过程需要原视频2-3倍的空间

## 🔧 依赖工具

应用依赖以下外部工具（需要单独安装）：

### FFmpeg (必需)

用于视频处理：

```bash
brew install ffmpeg
```

验证安装：

```bash
ffmpeg -version
```

## 🐛 常见问题

### Q: 启动时报错 "No module named 'PyQt6'"

**A**: 请安装GUI依赖：
```bash
pip install -r requirements_gui.txt
```

### Q: 处理时报错 "ffmpeg not found"

**A**: 请安装FFmpeg：
```bash
brew install ffmpeg
```

### Q: 字幕识别不准确

**A**: Whisper模型首次使用时需要下载，请确保网络连接正常。如果识别效果不佳，可以尝试：
- 确保视频音频清晰
- 手动编辑生成的SRT字幕文件

### Q: 翻译效果不理想

**A**: 建议在步骤2完成后暂停，手动校对和编辑翻译后的SRT文件，然后使用单步模式继续后续步骤。

### Q: 配音和字幕不同步

**A**: 确保翻译后的字幕文件的时间轴没有被修改。如果手动编辑了字幕，注意保持原有的时间戳格式。

### Q: 应用界面卡住不动

**A**: 处理大文件时可能需要较长时间，请耐心等待。查看日志窗口确认是否在正常处理。

## 📝 命令行版本

如果您更喜欢命令行界面，原始的CLI版本仍然可用：

```bash
python3 main.py
```

两个版本功能完全相同，只是交互方式不同。

## 🔄 更新日志

### v1.0 (当前版本)

- ✅ 完整的GUI界面
- ✅ 拖拽文件支持
- ✅ 实时进度显示
- ✅ 多线程处理避免界面卡顿
- ✅ 配置自动保存
- ✅ 支持7种目标语言
- ✅ 多种音色选择

## 📧 技术支持

如遇到问题，请查看日志窗口中的错误信息，通常能够帮助定位问题。

## 📄 许可证

本项目仅供学习和个人使用。
